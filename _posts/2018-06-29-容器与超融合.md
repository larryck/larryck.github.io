---
title: 超融合与容器
description: 
categories:
- k8s
tags:
- resource
---

本文将探讨我对超融合的一些认识，以及容器与超融合结合的一些思考。

# 超融合
## 超融合的起源
我知道的超融合概念是从Nutanix开始的。Nutanix的成功让工业界接受了超融合的概念，并刮起了一阵超融合的热潮。既然有这么多支持者，超融合肯定是解决了用户某一个方面的痛点问题的。接下来我将从Nutanix的创立初衷开始说起，看看超融合概念的起源及面向的应用场景。

Nutanix是由从Google和Oracle出来的一些存储专家于2009年创立的。创立之初，Nutanix解决的问题是如何让云环境摆脱对集中存储的依赖。在传统云环境搭建过程中，用户除了准备计算服务器之外，还需要准备一个集中存储阵列（通常是SAN）。由于集中存储阵列高昂的价格，这将让很多预算有限的小公司被拒于拥有自身的私有云平台大门之外。

另外一个问题是云平台规模预估与扩展。在传统的集群计算系统中，集群的扩展是一件很讨厌的事。这往往需要集群暂停服务，集群管理软件重新设置集群的配置，这才能让新扩展的机器加入到集群中。存储阵列的扩展则更加困难。为了避免后期扩展的带来的问题，用户往往会在初始搭建的时候以超出自身需要数倍的规模来搭建云平台，这进一步加大了成本压力，让很多小公司望而却步。

Nutanix提供了一种解决方案，让存储与计算融合在一起，构成一个全对等、无相关、可高度扩展的集群结构。集群中的机器都是对等的，用户可以通过添加机器进行集群在线扩容。从而，用户可以从2-3台机器组成的集群开始，在后期随着业务的扩展不断地往集群中添加机器即可以达到与业务匹配的集群规模。
## 超融合解决的核心问题
**超融合结构极大地方便了私有云的落地，降低了企业使用云平台的难度。**超融合架构从成本控制、运维简单、使用便利等方面为用户提供了一个完整的私有云解决方案。就像Nutanix秉承的信念一样，***“iPhone for the data centre”***：
> iPhone将计算器、相机、电子书阅读器等孤立的技术聚集在一起给用户提供了一个完整的移动平台。就像iPhone一样，超融合结构也会将企业计算平台中所需要的技术融合在一起为企业用户提供一个完整的私有云计算平台。


企业可以以很小的成本搭建自身的私有云环境进行体验，并通过云计算的优势降低自身的基础设施管理成本，从而提高企业效率。

超融合架构将在以下几个方面展现出巨大的优势：

- 成本控制：超融合系统从2-3个节点开始构建，让小企业也能负担得起；超融合系统能够线性扩展，用户可以随着业务的扩展而增加资源，可以最大程度的提高计算资源规模与业务规模的匹配度，最大程度的降低成本。
- 隐藏云平台的复杂度，让运维更简单：超融合架构采用标准机型，扩容及运维都只针对同一机型。超融合系统提供基于软件定义的错误管理，具有很高的错误隔离及自恢复能力。最终达到的效果是，运维变成了只需要增添机器及更换错误部件，大幅降低企业运维人员面对的复杂度。
- 使用简单：超融合系统具有统一的资源管理入口，全面的系统监控，以及高度的自动化。

## 超融合结构的核心技术
超融合系统将集群的计算资源、存储资源、网络资源分别池化，构建高可用、可扩展的软件定义计算、存储及网络资源池。

此外，超融合系统提供了完善的软件定义错误管理机制，每个资源池里边的错误都将被隔离在本资源池之内，并且系统能够第一时间进行自恢复，这保证了整个系统的稳定性。

因而，超融合架构的核心技术是软件定义技术，无论是资源还是错误或流程。通过软件定义的方式，将资源池化、错误隔离与愈合、管理自动化，超融合系统能够为私有云平台提供一个简单易用的抽象层，让云平台更方便运维与使用。超融合架构还融合很多云平台基础支撑功能，让云支撑环境更加完整。

# 业界的超融合产品
从Nutanix开始，计算池化与存储池化就是超融合架构一个标配功能，目前所有的超融合系统都提供计算与存储的融合。计算资源池化包括支持不同的虚拟化平台（KVM、XEN、HyperV等），提供热迁移、数据加密、HA等丰富的特性。存储资源池化也提供了丰富的功能：一般都支持基于SSD的读写cache、支持数据均衡分布、数据错误恢复以及故障报警等功能。随着新型存储设备的出现以及Flash存储设备的价格降低，业界也出现了很多NVMe与SSD搭档使用作为读写cache的方案以及全SSD超融合系统。

当然，很多公司也会根据自身的技术优势在自身的超融合系统中增加很多独特的新特性，例如：

- Nutanix：Nutanix从存储出发并且是超融合架构的推动者，因而其在存储特性及功能的全面性方面做了很多工作。Nutanix超融合系统提供了诸多存储特性，支持多种存储类型，并且提供了很多数据保护特性。同时，Nutanix系统在平台的全面性还提供了很多新功能，例如跨数据中心管理、应用安全、资费管理及数据库应用管理等。
- VMWare：VMWare在虚拟主机方面具有很强的技术优势。VMWare超融合系统将存储池化组件集成在虚拟主机软件之中，从而缩短了存储资源池的访问路径，提升存储资源池的性能。VMWare围绕着存储组件做了很多工作。
- 深信服：深信服在网络虚拟化方面有很深的技术积累，因而深信服的超融合系统重点强化了网络资源池的设计。深信服超融合系统增加了SDN、NFV等网络功能支持，增强了用户在使用过程中的网络组件体验，并且也为具有网络虚拟化功能需求的用户提供了诸多支持。

# 超融合与容器
之前的超融合系统都是为基于虚拟化技术的私有云平台设计。虽然业界有一些超融合产品宣称支持容器平台，但是并没有针对容器平台的特性进行设计。

容器云平台与虚拟化云平台在应用场景上具有诸多不同。例如：容器云平台未来更多的应用场景将会是微服务架构、无服务器架构应用，这些应用的特性与传统虚拟化云平台的应用特性有很大的区别。同时，容器应用快速部署、快速销毁的执行特性也会对底层平台提出新的需求。

容器云平台的运维与虚拟机平台的运维的也具有很大的差别。容器云平台在应用的管理方面会有很多新的需求，更加强化应用的生命周期管理、服务质量管理、错误追踪等，这就会要求容器云超融合系统在基础服务支撑方面更具有倾向性。

另外一个很大的不同是应用容器化与应用上虚拟机的难度是不一样的。虚拟化提供了完整的执行环境而容器化的应用会涉及到很多类似执行权限、镜像等问题。如何降低应用容器化的难度是容器云超融合系统提升用户体验需要面对的重要问题之一。

虽然有诸多挑战，我依然相信容器云超融合系统将会给用户带来巨大的价值。随着设计的成熟，容器云超融合系统将提供更加简单的平台运维方案，能够显著的降低用户应用上容器云的难度，并且更加强化容器技术的优势，让用户体验到容器技术带来的应用管理上的变革。成熟的容器云超融合系统能够提高用户的应用管理效率，进而提升企业效率。